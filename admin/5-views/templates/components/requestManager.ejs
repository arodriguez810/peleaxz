<script>
    var viewModel = MODAL.getViewData();
    <%= DATA.scope %>.WARNINGREQUESTS = WARNINGREQUESTS;
    DSON
</script>
<div
        ng-show="WARNINGREQUESTS.length<=0"
        class="alert alpha-<%= TAG.table %> border-<%= TAG.table %> alert-styled-left">
    There is no request that jeopardizes the performance of the application
</div>
<button onclick="HTTP.resetManager();" type="button" class="btn bg-<%= TAG.table %>-600 btn-icon">
    <span class="icon-reset"></span> Reset Report
</button>
<table class="table thistable table-togglable table-framed datatable">
    <thead class="bg-<%= TAG.table %>">
    <tr>
        <th>URL</th>
        <th>Method</th>
        <th>Time</th>
        <th>Params</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
    <tfoot>
    <tr>
        <th colspan="3" style="text-align:right">Total:</th>
        <th></th>
    </tr>
    </tfoot>
</table>
<script>
    $(document).ready(function () {
        var table = $('.thistable').DataTable({
            data: DSON.jsonToArray(WARNINGREQUESTS),
            "footerCallback": function (row, data, start, end, display) {
                var api = this.api(), data;

                // Remove the formatting to get integer data for summation
                var intVal = function (i) {
                    return typeof i === 'string' ?
                        i.replace(/[\$,]/g, '') * 1 :
                        typeof i === 'number' ?
                            i : 0;
                };

                // Total over all pages
                total = api.column(2).data().reduce(function (a, b) {
                    return intVal(a) + intVal(b);
                }, 0);

                // Total over this page
                pageTotal = api.column(2, {page: 'current'}).data().reduce(function (a, b) {
                    return intVal(a) + intVal(b);
                }, 0);

                var count = api.column(2, {page: 'current'}).data().length;

                // Update footer
                $(api.column(2).footer()).html('Average: ' + Number(pageTotal / count).toFixed(2) );
            }
        });

        $('.thistable tbody').on('mouseover', 'td', function () {
            var colIdx = table.cell(this).index().column;

            if (colIdx !== lastIdx) {
                $(table.cells().nodes()).removeClass('active');
                $(table.column(colIdx).nodes()).addClass('active');
            }
        }).on('mouseleave', function () {
            $(table.cells().nodes()).removeClass('active');
        });
    });
</script>