<%
var name = name || "";
var options = {
    placeholder: params.capitalize(name),
    type: "text",
    icon: {
        class: "none",
        position: "left",
        color: TAG.table+"-800"
    },
    helptext: '',
    format: '',
    readonly: false,
    disabled: false,
    autocomplete: '',
    posttype: "text"
    //maxlength: 10,

};
options = OBJECT.merge(options, opts);
options.autocomplete = options.autocomplete ? "autocomplete='Off'" : '';
options.format = options.format ? options.format : false;
options.model = options.model ? options.model : false;
var toclient = JSON.stringify(options);
%>
<script>
    <%= model %>.form.registerField("<%= name %>", "<%= toclient %>");

</script>
<div class="form-group-material form-group has-feedback has-{{<%= model %>.validation.getType('<%= name %>')}}  has-feedback-{{<%= model %>.form.options.<%= name %>.icon.position}}"
     id="input<%= name %>">
    <label

            class="control-label {{<%= model %>.form.LabelVisible('<%= name %>')?'is-visible animate':''}}">
        {{<%= model %>.form.options.<%= name %>.placeholder}}
    </label>
    <textarea
            ng-model="<%= model + "." + name %>" name="<%= model %>_<%= name %>"
            ng-readonly="<%= model %>.form.options.<%= name %>.readonly"
            ng-disabled="<%= model %>.form.options.<%= name %>.disabled"
            maxlength="{{<%= model %>.form.options.<%= name %>.maxlength}}"
            type="{{<%= model %>.form.options.<%= name %>.type}}"
            <%= options.model ? "value='{{" + options.model + "}}'" : "" %>
            class="form-control"
            placeholder="{{<%= model %>.form.options.<%= name %>.placeholder}}"></textarea>

    <div class="form-control-feedback">
        <i class="icon-{{<%= model %>.form.options.<%= name %>.icon.class}} text-{{<%= model %>.validation.getColor('<%= name %>',<%= model %>.form.options.<%= name %>.icon.color)}}">

        </i>
    </div>
    <span ng-if="<%= model %>.form.options.<%= name %>.helptext!=''"
          class="help-block text-muted">
        {{<%= model %>.form.options.<%= name %>.helptext}}
    </span>

    <span ng-show="<%= model %>.validation.getMessages('<%= name %>').length>0" class="help-block">
       <p class="text-{{$eval(validation).type}}"
          ng-repeat="(key,validation) in <%= model %>.validation.getMessages('<%= name %>') track by key">
               <i class="{{$eval(validation).icon}}"></i> {{$eval(validation).message}}
        </p>
    </span>
</div>
<script>
    $(document).ready(function () {
        <% if(options.format){ %>
        $('[name="<%= model %>_<%= name %>"]').formatter({
            pattern: '<%= options.format %>'
        });
        <% } %>
        <% if(options.maxlength){ %>
        $('[name="<%= model %>_<%= name %>"]').maxlength();
        <% } %>
        $('[name="<%= model %>_<%= name %>"]').keyup(function () {
            $(this).trigger("change");
        });
        $('[name="<%= model %>_<%= name %>"]').trigger("change");
        $('[name="<%= model %>_<%= name %>"]').blur(function () {
            STEP.register({
                    scope: "<%= model %>",
                    action: "Change TextArea",
                    field: "<%= name %>",
                    value: <%= model %>.<%= name %>
            });
            $(".map-wrapper").hide();
        });
        var isReadProgram = <%= model %>.form.isReadOnly('<%= name %>');
        if(isReadProgram!==false){
            <%= model %>.form.options.<%= name %>.disabled = true;
            if(isReadProgram!==undefined){
                <%= model %>.<%= name %> = isReadProgram;
                $('[name="<%= model %>_<%= name %>"]').html(isReadProgram)
            }
        }
    });
</script>