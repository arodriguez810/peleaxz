<%
var name = name || "";
var options = {
    title: params.capitalize(name),
    type: "text",
    icon: {
        class: "none",
        position: "left",
        color: TAG.table + "-800"
    },
    items: ['n/a']
};

options = OBJECT.merge(options, opts); var nameclean = name.replace(/\./g, '_');
options.model = options.model ? options.model : false;
var toclient = JSON.stringify(options);
%>
<script>
    if (!<%= model %>.
    charts
    )<%= model %>.charts = {};
    eval(`<%= model %>.charts.<%= name %> = ${"<%= toclient %>".replaceAll("&#34;", '"').replaceAll("&#39", "'")}`);
</script>

<script>

    $(function () {

        // Set paths
        // ------------------------------

        require.config({
            paths: {
                echarts: 'assets/js/plugins/visualization/echarts'
            }
        });
        require(
            [
                'echarts',
                'echarts/theme/limitless',
                'echarts/chart/pie',
                'echarts/chart/funnel'
            ],
            function (ec, limitless) {
                <%= model %>.
                charts.<%= name %>_chart = ec.init(document.getElementById('<%= name %>'), limitless);
                <%= model %>.
                charts.<%= name %>_chart_options = {
                    tooltip: {
                        trigger: 'item',
                        formatter: "{b}:<br/> {c} ({d}%)"
                    },
                    toolbox: {
                        show: true,
                        orient: 'horizontal',
                        x: 'left',
                        feature: {
                            restore: {
                                show: true,
                                title: 'Restore'
                            },
                            saveAsImage: {
                                show: true,
                                title: 'Same as image',
                                lang: ['Save']
                            }
                        }
                    },
                    calculable: true,
                    series: [{
                        type: 'pie',
                        radius: '60%',
                        center: ['40%', '55.5%'],
                        roseType: 'area',
                        data: <%= model %>.<%= name %>_data
                    }]
                };
                <%= model %>.
                charts.<%= name %>_chart.setOption(<%= model %>.charts.<%= name %>_chart_options);
                <%= model %>.charts.<%= name %>_chart.resize();
                setTimeout(function () {
                    <%= model %>.
                    charts.<%= name %>_chart.resize();
                }, 3000);
            }
        );
    });

</script>